import{g as v,r as l,j as e,s as m}from"./index-DMonaj-y.js";import{U as b}from"./user-BxGXrD_Z.js";import{Z as w}from"./zap--9GiD9i4.js";import{C as k}from"./check-CARfCKV0.js";import{P as S}from"./pen-line-C6r-IUKW.js";const _="https://hvbdpgkdcdskhpbdeeim.supabase.co";function f({profile:s,extracted:r,label:o}){const n=s.name.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2);return e.jsxs("div",{className:"bg-[#0a101d] border border-[#1d2839] rounded-xl overflow-hidden mb-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-[#a6ed2a]/20 via-[#a6ed2a]/10 to-transparent px-6 py-5",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-[#a6ed2a] flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-[#080c16] font-bold text-lg",children:n})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:s.name}),o&&e.jsx("span",{className:"text-xs text-gray-500",children:o})]}),s.affiliation&&e.jsx("p",{className:"text-sm text-[#a6ed2a] font-medium mt-0.5",children:s.affiliation}),s.location&&e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:s.location})]})]})}),e.jsxs("div",{className:"px-6 py-5 space-y-5",children:[s.bio&&e.jsx("p",{className:"text-gray-300 leading-relaxed",children:s.bio}),s.background&&e.jsxs("div",{className:"bg-[#080c16] border border-[#1d2839] rounded-lg p-4",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-2",children:"Background"}),e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:s.background})]}),s.skills&&s.skills.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#a6ed2a] uppercase tracking-wider mb-2 font-semibold",children:"Skills"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.skills.map((a,t)=>e.jsx("span",{className:"text-xs px-3 py-1.5 rounded-full bg-[#a6ed2a]/15 text-[#a6ed2a] border border-[#a6ed2a]/30 font-medium",children:a},t))})]}),s.experience&&s.experience.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wider mb-2 font-semibold",children:"Experience"}),e.jsx("div",{className:"border-l-2 border-[#333] pl-3 space-y-2",children:s.experience.map((a,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-gray-500 -ml-[0.9rem] flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-300",children:a})]},t))})]}),s.capabilities&&s.capabilities.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-blue-400 uppercase tracking-wider mb-2 font-semibold",children:"What I can do for others"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:s.capabilities.map((a,t)=>e.jsxs("div",{className:"bg-blue-900/15 border border-blue-800/25 rounded-lg px-3 py-2.5 text-sm text-blue-300 flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5 flex-shrink-0",children:"▸"}),a]},t))})]}),(s.offering&&s.offering.length>0||s.looking_for&&s.looking_for.length>0)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.offering&&s.offering.length>0&&e.jsxs("div",{className:"bg-green-900/10 border border-green-800/25 rounded-lg p-4",children:[e.jsx("div",{className:"text-xs text-green-400 uppercase tracking-wider mb-3 font-semibold",children:"Offering"}),e.jsx("div",{className:"space-y-2",children:s.offering.map((a,t)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 mt-0.5 flex-shrink-0",children:"+"}),e.jsx("p",{className:"text-sm text-green-300",children:a})]},t))})]}),s.looking_for&&s.looking_for.length>0&&e.jsxs("div",{className:"bg-amber-900/10 border border-amber-800/25 rounded-lg p-4",children:[e.jsx("div",{className:"text-xs text-amber-400 uppercase tracking-wider mb-3 font-semibold",children:"Looking for"}),e.jsx("div",{className:"space-y-2",children:s.looking_for.map((a,t)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-500 mt-0.5 flex-shrink-0",children:"◎"}),e.jsx("p",{className:"text-sm text-amber-300",children:a})]},t))})]})]}),s.interests&&s.interests.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-purple-400 uppercase tracking-wider mb-2 font-semibold",children:"Interests"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.interests.map((a,t)=>e.jsx("span",{className:"text-xs px-3 py-1.5 rounded-lg bg-purple-900/20 text-purple-300 border border-purple-700/30",children:a},t))})]}),r?.hlamt_tags&&r.hlamt_tags.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-2",children:"Dimensional Focus"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.hlamt_tags.map((a,t)=>e.jsx("span",{className:"text-xs px-2.5 py-1 rounded-full bg-[#a6ed2a]/10 text-[#a6ed2a] font-mono border border-[#a6ed2a]/20",children:a},t))})]})]})]})}function E(){const s=v(),[r,o]=l.useState(""),[n,a]=l.useState("loading"),[t,u]=l.useState(""),[d,h]=l.useState(null),[g,j]=l.useState(null),[p,N]=l.useState(null);l.useEffect(()=>{async function x(){const{data:{user:i}}=await m.auth.getUser();if(!i){s("/auth");return}j(i.id);const{data:c}=await m.from("participants").select("id, name, affiliation, bio, background, experience, skills, capabilities, interests, looking_for, offering, location").eq("auth_user_id",i.id).maybeSingle();c&&h(c),a("idle")}x()},[s]);async function y(x){if(x.preventDefault(),!(!r.trim()||!g)){a("submitting"),u("");try{a("extracting");const i=await fetch(`${_}/functions/v1/process-profile`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${(await m.auth.getSession()).data.session?.access_token}`},body:JSON.stringify({content:r,auth_user_id:g})}),c=await i.json();if(!i.ok)throw new Error(c.error||"Profile processing failed");h(c.participant),N(c.extracted),a("done")}catch(i){u(i?.message||"Something went wrong. Please try again."),a("error")}}}return n==="loading"?e.jsxs("div",{className:"max-w-2xl mx-auto text-center py-16",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-[#1d2839] flex items-center justify-center mx-auto mb-4 animate-pulse",children:e.jsx(b,{className:"w-8 h-8 text-gray-500"})}),e.jsx("p",{className:"text-gray-400",children:"Loading profile..."})]}):n==="extracting"?e.jsxs("div",{className:"max-w-2xl mx-auto text-center py-16",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-[#1d2839] flex items-center justify-center mx-auto mb-6 animate-pulse",children:e.jsx(w,{className:"w-8 h-8 text-[#a6ed2a]"})}),e.jsx("h2",{className:"text-xl font-bold mb-3",children:"Building your profile..."}),e.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:"AI is reading your introduction, extracting your name, interests, and dimensional focus."}),e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#a6ed2a] animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#a6ed2a] animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#a6ed2a] animate-bounce",style:{animationDelay:"300ms"}})]})]}):n==="done"&&d?e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-[#a6ed2a] flex items-center justify-center mx-auto mb-6",children:e.jsx(k,{className:"w-8 h-8 text-[#080c16]",strokeWidth:3})}),e.jsxs("h2",{className:"text-xl font-bold mb-3",children:["Profile ",p?.isUpdate?"updated":"created","!"]})]}),e.jsx(f,{profile:d,extracted:p}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsx("button",{onClick:()=>{a("idle"),o("")},className:"px-6 py-2.5 bg-[#1d2839] text-white rounded-lg hover:bg-[#283347] transition-colors text-sm",children:"Update profile"}),e.jsx("button",{onClick:()=>s("/contribute"),className:"px-6 py-2.5 bg-[#a6ed2a] text-[#080c16] rounded-lg hover:bg-[#b8f247] transition-colors text-sm",children:"Start contributing"})]})]}):e.jsxs("div",{className:"max-w-2xl mx-auto",children:[d?e.jsxs(e.Fragment,{children:[e.jsx(f,{profile:d,label:"Your current profile"}),e.jsxs("h1",{className:"text-2xl font-bold mb-2 flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-[#a6ed2a]"}),"Update Your Profile"]}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"Tell us what's changed. Write naturally — AI will update your profile."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"text-2xl font-bold mb-2 flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5 text-[#a6ed2a]"}),"Join the Commons"]}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"Introduce yourself. Write naturally — AI will extract your name, interests, and focus areas to build your profile."})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("textarea",{value:r,onChange:x=>o(x.target.value),placeholder:d?"Share what's new — new projects, interests, or affiliations. AI will update your profile accordingly.":"Hi, I'm... Tell us about yourself: your name, what you work on, what you're interested in, what brought you here. Write as much or as little as you want — the AI will figure out the structure.",rows:8,required:!0,className:"w-full bg-[#0a101d] border border-[#1d2839] rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-[#a6ed2a] resize-y leading-relaxed text-base"}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"AI extracts your name, affiliation, bio, interests, and dimensional focus."}),e.jsxs("span",{className:"text-xs text-gray-500",children:[r.length," chars"]})]})]}),t&&e.jsx("div",{className:"p-3 bg-red-900/20 border border-red-800/30 rounded-lg text-sm text-red-300",children:t}),e.jsx("button",{type:"submit",disabled:n==="submitting"||!r.trim(),className:"w-full bg-[#a6ed2a] text-[#080c16] hover:bg-[#b8f247] py-3 rounded-lg transition-colors disabled:opacity-50",children:n==="submitting"?"Saving...":d?"Update Profile":"Create Profile"})]})]})}export{E as Profile};
