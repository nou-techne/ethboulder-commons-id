const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Graph-DVMaZ8a2.js","assets/index-DMonaj-y.js","assets/index-BDqlw_6p.css","assets/CoordinateButton-B7UZJu6H.js","assets/handshake-DwTesg8Y.js","assets/EmptyState-BaUrHS-t.js","assets/network-C-19DYVo.js"])))=>i.map(i=>d[i]);
import{u as V,r as s,s as a,j as e,I as W,L as o,A as Z,R as J,a as Q,_ as X}from"./index-DMonaj-y.js";import{C as S,a as Y,S as ee,R as te,b as se}from"./SessionsList-5CiHPYHF.js";import{E as ae}from"./ExtractionProgress-BhWNDxCC.js";import{A as ne}from"./activity-CVwqszFm.js";import{U as re}from"./users-DbK4I6RR.js";import{L as ce}from"./link-2-BHR6Oleo.js";import{F as le}from"./flame-Bj47EPu_.js";import{T as ie}from"./trending-up-Br8ckqyC.js";import{C as oe}from"./chevron-right-BOIFnP4B.js";import"./clock-B04Z_VSO.js";import"./calendar-DZREd-sc.js";import"./map-pin-neHb5Zrs.js";const de=s.lazy(()=>X(()=>import("./Graph-DVMaZ8a2.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(h=>({default:h.Graph})));function C(h){const r=Math.floor((Date.now()-new Date(h).getTime())/1e3);return r<60?`${r}s ago`:r<3600?`${Math.floor(r/60)}m ago`:r<86400?`${Math.floor(r/3600)}h ago`:`${Math.floor(r/86400)}d ago`}function we(){const{convergence:h}=V(),r=h.dimensions,[n,k]=s.useState({artifacts:0,participants:0,relationships:0,signals:0,lastHour:0}),[A,E]=s.useState({}),[c,L]=s.useState([]),[j,R]=s.useState([]),[I,D]=s.useState(null),[b,M]=s.useState(0),[N,$]=s.useState(!1),[F,q]=s.useState({}),[d,v]=s.useState(0),l=8,[f,P]=s.useState(!1),T=s.useRef(null);s.useEffect(()=>{function t(){P(!!document.fullscreenElement)}return document.addEventListener("fullscreenchange",t),()=>document.removeEventListener("fullscreenchange",t)},[]);async function p(){const[{count:t},{count:i},{count:x},{count:O}]=await Promise.all([a.from("artifacts").select("*",{count:"exact",head:!0}),a.from("public_participants").select("*",{count:"exact",head:!0}),a.from("artifact_relationships").select("*",{count:"exact",head:!0}),a.from("coordination_interests").select("*",{count:"exact",head:!0})]),H=new Date(Date.now()-3600*1e3).toISOString(),{count:G}=await a.from("contributions").select("*",{count:"exact",head:!0}).gte("created_at",H);k({artifacts:t||0,participants:i||0,relationships:x||0,signals:O||0,lastHour:G||0});const[{data:y},{data:w}]=await Promise.all([a.from("tags").select("name, artifact_tags(count)").like("name","hlamt:%"),a.rpc("word_frequencies")]),u={};if(y)for(const m of y){const K=m.artifact_tags;u[m.name]=K?.[0]?.count??0}w&&(u["hlamt:L"]=w.length),E(u);const{data:B}=await a.from("contribution_feed").select("*").limit(20);L(B||[]);const{data:U}=await a.from("artifacts").select("*").order("created_at",{ascending:!1}).limit(8);R(U||[]);const{data:g}=await a.rpc("chain_head");g&&g.length>0&&g[0].head_seq&&M(g[0].head_seq);const z=await se(),_={};for(const m of z)m.tag_name.startsWith("hlamt:")&&(_[m.tag_name]=m.total_signals);q(_)}return s.useEffect(()=>{p();const t=setInterval(p,1e4),i=a.channel("live-updates").on("postgres_changes",{event:"*",schema:"public",table:"artifacts"},p).on("postgres_changes",{event:"*",schema:"public",table:"contributions"},p).subscribe();return()=>{clearInterval(t),a.removeChannel(i)}},[]),e.jsxs("div",{className:"pb-4 flex flex-col min-h-[calc(100vh-64px)]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-[#a6ed2a] font-bold text-xl tracking-tight",children:"EthBoulder"}),e.jsx("span",{className:"text-gray-500 text-xl",children:".commons.id"}),e.jsx("span",{className:"text-gray-600 text-xs ml-2 hidden sm:inline",children:"Knowledge Graph · Live"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"hidden md:flex items-center gap-3 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1 text-gray-400",children:[e.jsx(ne,{className:"w-3 h-3 text-[#a6ed2a]"}),e.jsx("span",{className:"font-mono text-white",children:n.artifacts})," artifacts"]}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-400",children:[e.jsx(re,{className:"w-3 h-3 text-violet-500"}),e.jsx("span",{className:"font-mono text-white",children:n.participants})," people"]}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-400",children:[e.jsx(ce,{className:"w-3 h-3 text-cyan-500"}),e.jsx("span",{className:"font-mono text-white",children:n.relationships})," edges"]}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-400",children:[e.jsx(le,{className:"w-3 h-3 text-orange-400"}),e.jsx("span",{className:"font-mono text-white",children:n.signals})," signals"]}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-400",children:[e.jsx(ie,{className:"w-3 h-3 text-[#a6ed2a]"}),e.jsx("span",{className:"font-mono text-white",children:n.lastHour}),"/hr"]})]}),e.jsx("button",{onClick:()=>$(!N),className:"flex items-center gap-1 text-xs text-gray-500 hover:text-[#a6ed2a] transition-colors",children:e.jsx(W,{className:"w-3.5 h-3.5"})})]})]}),e.jsxs("div",{className:"flex md:hidden items-center justify-between gap-2 mb-2 text-[10px] text-gray-400",children:[e.jsxs("span",{children:[e.jsx("span",{className:"font-mono text-white",children:n.artifacts})," artifacts"]}),e.jsxs("span",{children:[e.jsx("span",{className:"font-mono text-white",children:n.participants})," people"]}),e.jsxs("span",{children:[e.jsx("span",{className:"font-mono text-white",children:n.relationships})," edges"]}),e.jsxs("span",{children:[e.jsx("span",{className:"font-mono text-white",children:n.signals})," signals"]}),e.jsxs("span",{children:[e.jsx("span",{className:"font-mono text-white",children:n.lastHour}),"/hr"]})]}),N&&e.jsxs("div",{className:"mb-2 bg-[#0a101d] border border-[#1d2839] rounded-lg px-4 py-2.5 text-xs text-gray-400 leading-relaxed",children:["A ",e.jsx("strong",{className:"text-gray-300",children:"living knowledge graph"})," for ETHBoulder 2026. Contribute naturally — AI extracts artifacts, tags dimensions, connects the graph.",e.jsx(o,{to:"/contribute",className:"text-[#a6ed2a] hover:text-white ml-2",children:"Try it →"})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-3",children:r.map(t=>{const i=A[t.tag]??0,x=F[t.tag]??0;return e.jsxs(o,{to:`/d/${t.key}`,className:"block rounded border bg-[#0a101d] px-2 py-1.5 hover:border-[#a6ed2a] transition-colors group",style:x>0?{borderColor:`rgba(245,158,11,${Math.min(.6,x*.15)})`}:{borderColor:"#1d2839"},children:[e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsxs("span",{className:"font-mono text-sm font-bold",style:{color:t.color},children:[t.letter,"/"]}),e.jsx("span",{className:"text-sm font-bold text-white",children:i}),x>0&&e.jsx("span",{className:"text-[9px] text-amber-400 ml-auto",children:x})]}),e.jsx("div",{className:"text-[9px] text-gray-500 uppercase tracking-wide leading-none truncate",children:t.name})]},t.key)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-3 flex-1 min-h-0",children:[e.jsxs("div",{className:"lg:col-span-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h2",{className:"text-[10px] font-semibold text-gray-500 uppercase tracking-wider",children:"Graph Constellation"}),e.jsx(o,{to:"/explore",className:"text-[10px] text-[#a6ed2a] hover:text-white transition-colors",children:"Explorer →"})]}),e.jsxs("div",{ref:T,className:`relative ${f?"bg-[#080c16] w-screen h-screen flex flex-col":""}`,children:[e.jsx(s.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500 text-sm",children:"Loading..."})}),children:e.jsx("div",{className:`relative w-full rounded-lg border border-[#1d2839] overflow-hidden ${f?"flex-1":"h-[350px] sm:h-[420px] md:h-[520px] lg:h-[calc(100vh-260px)]"}`,children:e.jsx(de,{replaySeq:I})})}),f&&e.jsx("div",{className:"p-2 pt-0",children:e.jsx(S,{compact:!0})})]})]}),e.jsxs("div",{className:"lg:col-span-4 min-w-0 flex flex-col gap-3",children:[e.jsxs("div",{className:"flex-1 min-h-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h2",{className:"text-[10px] font-semibold text-gray-500 uppercase tracking-wider",children:"Live Activity"}),c.length>l&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>v(t=>Math.max(0,t-1)),disabled:d===0,className:"p-0.5 text-xs rounded bg-[#0a101d] border border-[#1d2839] text-gray-300 hover:border-[#a6ed2a] transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(Y,{className:"w-3 h-3"})}),e.jsxs("span",{className:"text-[10px] text-gray-500",children:[d*l+1,"–",Math.min((d+1)*l,c.length),"/",c.length]}),e.jsx("button",{onClick:()=>v(t=>Math.min(Math.ceil(c.length/l)-1,t+1)),disabled:(d+1)*l>=c.length,className:"p-0.5 text-xs rounded bg-[#0a101d] border border-[#1d2839] text-gray-300 hover:border-[#a6ed2a] transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(oe,{className:"w-3 h-3"})})]})]}),c.length===0?e.jsxs("div",{className:"text-gray-500 text-center py-6 text-xs bg-[#0a101d] border border-[#1d2839] rounded",children:["No contributions yet. ",e.jsx(o,{to:"/contribute",className:"text-[#a6ed2a]",children:"Be the first."})]}):e.jsx("div",{className:"space-y-1",children:c.slice(d*l,(d+1)*l).map(t=>e.jsxs(o,{to:`/contribution/${t.id}`,className:"block bg-[#0a101d] border border-[#1d2839] rounded px-2 py-1.5 hover:border-[#a6ed2a] transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full flex-shrink-0 ${t.status==="complete"?"bg-[#a6ed2a]":t.status==="processing"?"bg-blue-400 animate-pulse":t.status==="error"?"bg-red-400":"bg-yellow-400"}`}),t.participant_name&&t.participant_id&&e.jsx(o,{to:`/p/${t.participant_id}`,className:"text-[11px] font-medium text-gray-300 truncate hover:text-[#a6ed2a]",onClick:i=>i.stopPropagation(),children:t.participant_name}),t.participant_name&&!t.participant_id&&e.jsx("span",{className:"text-[11px] font-medium text-gray-300 truncate",children:t.participant_name}),e.jsx("span",{className:"text-[10px] text-gray-600 ml-auto flex-shrink-0",children:C(t.created_at)})]}),t.title&&e.jsx("p",{className:"text-[11px] font-medium text-white mb-0.5 truncate",children:t.title}),e.jsx("p",{className:"text-[10px] text-gray-400 line-clamp-1",children:t.preview}),t.status==="complete"&&(t.artifact_count>0||t.relationship_count>0)&&e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[t.artifact_count>0&&e.jsxs("span",{className:"text-[10px] text-gray-500",children:[e.jsx("span",{className:"font-mono text-[#a6ed2a]",children:t.artifact_count})," nodes"]}),t.relationship_count>0&&e.jsxs("span",{className:"text-[10px] text-gray-500",children:[e.jsx("span",{className:"font-mono text-[#a6ed2a]",children:t.relationship_count})," edges"]}),t.commitment_count>0&&e.jsxs("span",{className:"text-[10px] text-gray-500",children:[e.jsx("span",{className:"font-mono text-amber-400",children:t.commitment_count})," commits"]})]}),t.status==="processing"&&e.jsx("div",{className:"mt-0.5",children:e.jsx(ae,{startedAt:t.created_at,compact:!0})}),t.status==="error"&&e.jsx("span",{className:"text-[10px] text-red-400",children:"Failed"})]},t.id))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-[10px] font-semibold text-gray-500 mb-1 uppercase tracking-wider",children:"Sessions"}),e.jsx(ee,{compact:!0,limit:6})]}),j.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-[10px] font-semibold text-gray-500 mb-1 uppercase tracking-wider",children:"Recent Artifacts"}),e.jsx("div",{className:"space-y-0.5",children:j.map(t=>e.jsxs(o,{to:`/artifact/${t.id}`,className:"flex items-center gap-2 bg-[#0a101d] border border-[#1d2839] rounded px-2 py-1 hover:border-[#a6ed2a] transition-colors",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full flex-shrink-0",style:{backgroundColor:Z[t.type]}}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"font-medium text-[10px] text-white truncate",children:t.title})}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[t.rea_role&&e.jsx("span",{className:"text-[9px]",style:{color:Q[t.rea_role]},children:J[t.rea_role]}),e.jsx("span",{className:"text-[9px] text-gray-600",children:C(t.created_at)})]})]},t.id))})]})]})]}),b>0&&e.jsxs("div",{className:"mt-3 bg-[#0a101d]/80 border border-[#1d2839] rounded px-4 py-1.5 flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("h3",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Chain Replay"}),e.jsx(S,{compact:!0})]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx(te,{maxSeq:b,onSeqChange:t=>D(t)})})]})]})}export{we as default};
