import{h as N,r as l,s as b,j as e,i,L as v}from"./index-CJNRV6Bu.js";import{F as S}from"./file-text-CWlUXzuk.js";import{M as w}from"./message-square-DzdkE6Ft.js";function k(){const[d,g]=N(),[s,x]=l.useState(d.get("q")||""),[c,n]=l.useState([]),[o,h]=l.useState(!1),[u,p]=l.useState(!1);l.useEffect(()=>{const t=d.get("q");t&&t!==s&&(x(t),f(t))},[d]);const f=async t=>{if(!t.trim()){n([]),p(!1);return}h(!0),p(!0);try{const{data:a,error:r}=await b.rpc("search_content",{query_text:t});r?(console.error("Search error:",r),n([])):n(a||[])}catch(a){console.error("Search exception:",a),n([])}finally{h(!1)}},y=t=>{t.preventDefault(),s.trim()&&(g({q:s.trim()}),f(s.trim()))},j=t=>{const a=Math.floor((Date.now()-new Date(t).getTime())/1e3);if(a<60)return`${a}s ago`;const r=Math.floor(a/60);if(r<60)return`${r}m ago`;const m=Math.floor(r/60);return m<24?`${m}h ago`:`${Math.floor(m/24)}d ago`};return e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Search"}),e.jsxs("form",{onSubmit:y,className:"relative",children:[e.jsx("label",{htmlFor:"search-query",className:"sr-only",children:"Search query"}),e.jsx("input",{id:"search-query",type:"text",value:s,onChange:t=>x(t.target.value),placeholder:"Search artifacts and contributions...",className:"w-full px-4 py-3 pl-12 bg-[#0a101d] border border-[#1d2839] rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-[#a6ed2a]",autoFocus:!0}),e.jsx(i,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),e.jsx("button",{type:"submit",className:"absolute right-2 top-1/2 -translate-y-1/2 px-4 py-1.5 bg-[#a6ed2a] text-[#080c16] rounded-lg hover:bg-[#b8f247] text-sm font-medium",children:"Search"})]})]}),o&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(i,{className:"w-12 h-12 text-gray-500 mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-gray-400",children:"Searching..."})]}),!o&&u&&c.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(i,{className:"w-12 h-12 text-gray-500 mx-auto mb-4"}),e.jsxs("p",{className:"text-gray-400 mb-2",children:['No results found for "',s,'"']}),e.jsx("p",{className:"text-sm text-gray-500",children:"Try different keywords or check your spelling"})]}),!o&&c.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 text-sm text-gray-500",children:[c.length," ",c.length===1?"result":"results",' for "',s,'"']}),e.jsx("div",{className:"space-y-4",children:c.map(t=>e.jsx("div",{className:"bg-[#0a101d] border border-[#1d2839] rounded-lg p-4 hover:border-[#333] transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-1",children:t.result_type==="artifact"?e.jsx(S,{className:"w-5 h-5 text-[#a6ed2a]"}):e.jsx(w,{className:"w-5 h-5 text-cyan-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx(v,{to:t.result_type==="artifact"?`/artifact/${t.id}`:"/me",className:"font-medium text-white hover:text-[#a6ed2a] transition-colors",children:t.title}),e.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:j(t.created_at)})]}),e.jsx("div",{className:"text-sm text-gray-400 line-clamp-2",dangerouslySetInnerHTML:{__html:t.snippet}}),e.jsx("div",{className:"mt-2 flex items-center gap-2",children:e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[#1d2839] text-gray-400",children:t.result_type})})]})]})},`${t.result_type}-${t.id}`))})]}),!u&&!o&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(i,{className:"w-12 h-12 text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 mb-2",children:"Search the knowledge graph"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enter keywords to find artifacts and contributions"})]})]})}export{k as Search};
