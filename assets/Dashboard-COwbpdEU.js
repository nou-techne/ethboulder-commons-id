import{r as d,s as n,j as e,U as j,L as v,T as N}from"./index-B7mgF8z9.js";import{A as y}from"./activity-C1x9A6oR.js";const w={resource:"bg-green-500",event:"bg-amber-500",agent:"bg-blue-500"};function C(){const[o,g]=d.useState({totalArtifacts:0,totalParticipants:0,totalRelationships:0,recentContributions:0}),[u,b]=d.useState([]),[m,f]=d.useState([]),i=async()=>{const{count:t}=await n.from("artifacts").select("*",{count:"exact",head:!0}),{count:s}=await n.from("artifacts").select("*",{count:"exact",head:!0}).eq("rea_role","agent").eq("agent_type","human"),{count:a}=await n.from("artifact_relationships").select("*",{count:"exact",head:!0}),l=new Date(Date.now()-3600*1e3).toISOString(),{count:r}=await n.from("contributions").select("*",{count:"exact",head:!0}).gte("created_at",l);g({totalArtifacts:t||0,totalParticipants:s||0,totalRelationships:a||0,recentContributions:r||0})},x=async()=>{const{data:t}=await n.from("artifacts").select("id, title, created_at, rea_role").order("created_at",{ascending:!1}).limit(8);t&&b(t)},h=async()=>{const{data:t}=await n.from("artifact_tags").select("tag").like("tag","hlamt:%");if(t){const s={};t.forEach(r=>{const c=r.tag.split(":")[1];s[c]=(s[c]||0)+1});const a={E:"bg-emerald-500",H:"bg-violet-500",L:"bg-pink-500",A:"bg-cyan-500",M:"bg-amber-500",T:"bg-orange-500"},l=Object.entries(s).map(([r,c])=>({dimension:r,count:c,color:a[r]||"bg-gray-500"}));l.sort((r,c)=>c.count-r.count),f(l)}};d.useEffect(()=>{i(),x(),h();const t=setInterval(()=>{i(),x(),h()},1e4),s=n.channel("dashboard-updates").on("postgres_changes",{event:"*",schema:"public",table:"artifacts"},i).on("postgres_changes",{event:"*",schema:"public",table:"contributions"},i).on("postgres_changes",{event:"*",schema:"public",table:"relationships"},i).subscribe();return()=>{clearInterval(t),n.removeChannel(s)}},[]);const p=t=>{const s=Math.floor((Date.now()-new Date(t).getTime())/1e3);if(s<60)return`${s}s`;const a=Math.floor(s/60);return a<60?`${a}m`:`${Math.floor(a/60)}h`};return e.jsxs("div",{className:"min-h-screen bg-[#0f0f0f] text-gray-100 p-8",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[e.jsx("div",{className:"text-[#c3fd50] font-bold text-5xl tracking-tight",children:"EthBoulder"}),e.jsx("div",{className:"text-gray-500 text-5xl",children:".commons.id"})]}),e.jsx("div",{className:"text-gray-500 text-lg",children:"Knowledge Graph Â· Live"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-800 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(y,{className:"w-8 h-8 text-[#c3fd50]"})}),e.jsx("div",{className:"text-4xl font-bold mb-1",children:o.totalArtifacts}),e.jsx("div",{className:"text-gray-500 text-sm uppercase tracking-wide",children:"Artifacts"})]}),e.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-800 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(j,{className:"w-8 h-8 text-violet-500"})}),e.jsx("div",{className:"text-4xl font-bold mb-1",children:o.totalParticipants}),e.jsx("div",{className:"text-gray-500 text-sm uppercase tracking-wide",children:"Participants"})]}),e.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-800 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500"})}),e.jsx("div",{className:"text-4xl font-bold mb-1",children:o.totalRelationships}),e.jsx("div",{className:"text-gray-500 text-sm uppercase tracking-wide",children:"Relationships"})]}),e.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-800 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(N,{className:"w-8 h-8 text-[#c3fd50]"})}),e.jsx("div",{className:"text-4xl font-bold mb-1",children:o.recentContributions}),e.jsx("div",{className:"text-gray-500 text-sm uppercase tracking-wide",children:"Last Hour"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-800 rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-300",children:"Recent Artifacts"}),e.jsx("div",{className:"space-y-3",children:u.map(t=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-[#0f0f0f] rounded border border-gray-800",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${w[t.rea_role]}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-200 truncate",children:t.title}),e.jsxs("div",{className:"text-sm text-gray-500",children:[p(t.created_at)," ago"]})]})]},t.id))})]}),e.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-800 rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-300",children:"Dimension Distribution"}),e.jsx("div",{className:"space-y-4",children:m.map(t=>{const s=m[0]?.count||1,a=t.count/s*100;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded ${t.color}`}),e.jsxs("span",{className:"text-gray-300 font-medium",children:[t.dimension,"/"]})]}),e.jsx("span",{className:"text-2xl font-bold",children:t.count})]}),e.jsx("div",{className:"w-full bg-[#0f0f0f] rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full ${t.color} transition-all duration-500`,style:{width:`${a}%`}})})]},t.dimension)})})]})]}),e.jsxs("div",{className:"fixed bottom-6 right-6 flex items-center gap-2 bg-[#1a1a1a] border border-gray-800 rounded-full px-4 py-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#c3fd50] animate-pulse"}),e.jsx("span",{className:"text-sm text-gray-400",children:"LIVE"})]})]})}export{C as default};
